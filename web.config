<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <httpProtocol>
      <customHeaders>
        <!-- 1) 正式用“响应头”下发 CSP（不要再用 <meta http-equiv>） -->
        <add name="Content-Security-Policy" value="default-src 'self'; img-src 'self' data:; script-src 'self'; style-src 'self'; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'" />
        <!-- 2) 防点击劫持（与上面的 frame-ancestors 二选一，也可两者同开以兼容老浏览器） -->
        <add name="X-Frame-Options" value="DENY" />
      </customHeaders>
    </httpProtocol>
  </system.webServer>

  <!-- 确保 robots.txt 等静态文件也带 CSP（通常不需要此段，但你当前正被 robots.txt 告警，稳妥起见加上） -->
  <location path="robots.txt">
    <system.webServer>
      <httpProtocol>
        <customHeaders>
          <add name="Content-Security-Policy" value="default-src 'self'; img-src 'self' data:; script-src 'self'; style-src 'self'; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'" />
          <add name="X-Frame-Options" value="DENY" />
        </customHeaders>
      </httpProtocol>
    </system.webServer>
  </location>
</configuration>
